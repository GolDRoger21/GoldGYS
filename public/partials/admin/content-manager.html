<!-- VIEW 1: LIST VIEW (Default) -->
<div id="contentManagerListView" class="d-flex h-100 w-100">
    <!-- Sidebar: Konu Ağacı -->
    <aside class="content-sidebar d-flex flex-column border-end border-secondary bg-dark-subtle"
        style="width: 320px; flex-shrink: 0;">
        <div class="sidebar-header p-3 border-bottom border-secondary">
            <h5 class="mb-2 fw-bold text-white"><i class="bi bi-journal-bookmark-fill me-2 text-gold"></i>Müfredat</h5>
            <div class="input-group input-group-sm">
                <span class="input-group-text bg-black border-secondary text-muted"><i class="bi bi-search"></i></span>
                <input type="text" id="topicSearch" class="form-control bg-black border-secondary text-white"
                    placeholder="Konu ara...">
            </div>
        </div>
        <div id="topicTreeList" class="flex-grow-1 overflow-auto custom-scrollbar p-2">
            <!-- Topics Loaded via JS -->
            <div class="text-center mt-5 text-muted small">
                <div class="spinner-border spinner-border-sm mb-2 text-gold"></div>
                <div>Konular yükleniyor...</div>
            </div>
        </div>
    </aside>

    <!-- Main: İçerik Listesi & Özeti -->
    <main class="flex-grow-1 d-flex flex-column bg-dark h-100 overflow-hidden">

        <!-- Empty State (No Topic Selected) -->
        <div id="emptyState" class="h-100 d-flex flex-column align-items-center justify-content-center text-center p-5">
            <div class="mb-4 text-secondary opacity-25">
                <i class="bi bi-collection-play fw-bold" style="font-size: 5rem;"></i>
            </div>
            <h2 class="fw-bold text-white mb-2">İçerik Yönetimi</h2>
            <p class="text-muted lead mb-4" style="max-width: 500px;">
                Müfredat ağacından bir konu seçerek o konuya ait ders notlarını, videoları ve testleri yönetebilirsiniz.
            </p>
        </div>

        <!-- Content Panel (Topic Selected) -->
        <div id="contentPanel" class="d-none flex-column h-100">
            <!-- Header Info -->
            <div class="p-4 border-bottom border-secondary bg-gradient-dark">
                <div class="d-flex justify-content-between align-items-start mb-3">
                    <div>
                        <div class="d-flex align-items-center gap-2 mb-2">
                            <span class="badge border border-gold text-gold bg-gold-subtle"
                                id="headerCategoryBadge">Alan Bilgisi</span>
                            <span class="badge border border-secondary text-secondary" id="contentCountBadge">0
                                İçerik</span>
                        </div>
                        <h2 class="mb-1 text-white fw-bold display-6" id="headerTitle">Seçili Konu Başlığı</h2>
                        <p class="text-muted mb-0 font-monospace small" id="headerSubTitle">Alt Konu Detayı</p>
                    </div>
                    <div>
                        <button class="btn btn-gold fw-bold shadow-lg" type="button" data-bs-toggle="dropdown">
                            <i class="bi bi-plus-lg me-2"></i>Yeni İçerik
                        </button>
                        <ul class="dropdown-menu dropdown-menu-dark shadow border-secondary mt-2">
                            <li>
                                <h6 class="dropdown-header text-uppercase small text-muted">Medya & Döküman</h6>
                            </li>
                            <li><button class="dropdown-item py-2"
                                    onclick="window.ContentManager.openEditor('video')"><i
                                        class="bi bi-youtube me-2 text-danger"></i>Video Ekle</button></li>
                            <li><button class="dropdown-item py-2" onclick="window.ContentManager.openEditor('pdf')"><i
                                        class="bi bi-file-earmark-pdf me-2 text-warning"></i>PDF Ekle</button></li>
                            <li><button class="dropdown-item py-2" onclick="window.ContentManager.openEditor('html')"><i
                                        class="bi bi-file-text me-2 text-success"></i>Ders Notu (HTML)</button></li>
                            <li>
                                <hr class="dropdown-divider border-secondary">
                            </li>
                            <li>
                                <h6 class="dropdown-header text-uppercase small text-muted">Ölçme & Değerlendirme</h6>
                            </li>
                            <li><button class="dropdown-item py-2 fw-bold text-white"
                                    onclick="window.ContentManager.openEditor('quiz')"><i
                                        class="bi bi-ui-checks me-2 text-primary"></i>Test / Soru Ekle</button></li>
                        </ul>
                    </div>
                </div>

                <!-- Stats Cards -->
                <div class="d-flex gap-3 mt-4" id="contentSummary">
                    <div class="stat-card active" role="button" data-type="all">
                        <small class="text-muted text-uppercase fw-bold" style="font-size: 0.65rem;">Toplam</small>
                        <div class="fs-4 fw-bold text-white" id="contentTotalCount">0</div>
                    </div>
                    <div class="stat-card" role="button" data-type="video">
                        <small class="text-danger text-uppercase fw-bold" style="font-size: 0.65rem;">Video</small>
                        <div class="fs-4 fw-bold text-white" id="contentVideoCount">0</div>
                    </div>
                    <div class="stat-card" role="button" data-type="quiz">
                        <small class="text-primary text-uppercase fw-bold" style="font-size: 0.65rem;">Test</small>
                        <div class="fs-4 fw-bold text-white" id="contentQuizCount">0</div>
                    </div>
                    <div class="stat-card" role="button" data-type="pdf">
                        <small class="text-warning text-uppercase fw-bold" style="font-size: 0.65rem;">PDF</small>
                        <div class="fs-4 fw-bold text-white" id="contentPdfCount">0</div>
                    </div>
                    <div class="stat-card" role="button" data-type="html">
                        <small class="text-success text-uppercase fw-bold" style="font-size: 0.65rem;">Not</small>
                        <div class="fs-4 fw-bold text-white" id="contentHtmlCount">0</div>
                    </div>
                </div>
            </div>

            <!-- Toolbar -->
            <div class="p-2 border-bottom border-secondary bg-dark-subtle d-flex align-items-center gap-3">
                <div class="input-group input-group-sm w-auto flex-grow-1 ps-2" style="max-width: 400px;">
                    <span class="input-group-text bg-black border-secondary text-secondary"><i
                            class="bi bi-search"></i></span>
                    <input type="text" id="contentSearchInput" class="form-control bg-black border-secondary text-white"
                        placeholder="İçerik başlıklarında ara...">
                </div>
                <div class="d-flex gap-2 ms-auto pe-2">
                    <select id="contentSortSelect"
                        class="form-select form-select-sm bg-black text-white border-secondary w-auto">
                        <option value="order-asc">Sıralama (Artan)</option>
                        <option value="order-desc">Sıralama (Azalan)</option>
                        <option value="date-new">En Yeni</option>
                        <option value="date-old">En Eski</option>
                    </select>
                    <button class="btn btn-sm btn-icon btn-outline-secondary" id="btnRefresh" title="Yenile"><i
                            class="bi bi-arrow-clockwise"></i></button>
                </div>
            </div>

            <!-- List Workspace -->
            <div id="contentWorkspace" class="flex-grow-1 overflow-auto custom-scrollbar p-3">
                <!-- Content Cards injected here -->
            </div>
        </div>
    </main>
</div>

<!-- VIEW 2: FULL SCREEN EDITOR (Hidden by default) -->
<div id="contentManagerEditorView" class="d-none position-fixed top-0 start-0 w-100 h-100 bg-dark z-index-top"
    style="z-index: 2000;">
    <div class="d-flex flex-column h-100">
        <!-- Editor Toolbar -->
        <header
            class="editor-toolbar d-flex align-items-center justify-content-between p-3 border-bottom border-secondary bg-dark-subtle">
            <div class="d-flex align-items-center gap-3">
                <button class="btn btn-outline-secondary text-light btn-sm px-3"
                    onclick="window.ContentManager.closeEditor()">
                    <i class="bi bi-arrow-left me-2"></i>Vazgeç
                </button>
                <div class="border-start border-secondary h-100 mx-2"></div>
                <div>
                    <div class="d-flex align-items-center gap-2">
                        <span class="badge bg-gold text-dark fw-bold" id="editorModeBadge">YENİ EKLE</span>
                        <span class="text-white fw-bold" id="editorTitle">Test İçeriği</span>
                    </div>
                </div>
            </div>
            <div class="d-flex align-items-center gap-2">
                <span class="text-muted small me-3" id="saveStatusIndicator"></span>
                <button class="btn btn-primary btn-gold px-4 fw-bold shadow-sm"
                    onclick="window.ContentManager.saveContent()" id="btnSaveEditor">
                    <i class="bi bi-check-lg me-2"></i>Kaydet & Yayına Al
                </button>
            </div>
        </header>

        <!-- Editor Body -->
        <div class="flex-grow-1 overflow-hidden d-flex">

            <!-- Left: Metadata Panel -->
            <div class="editor-sidebar overflow-auto custom-scrollbar p-4 border-end border-secondary bg-black"
                style="width: 350px;">
                <h6 class="text-uppercase text-gold fw-bold small mb-4 letter-spacing-1">Genel Ayarlar</h6>

                <input type="hidden" id="inpContentType">

                <div class="mb-4">
                    <label class="form-label text-muted small fw-bold">BAŞLIK</label>
                    <input type="text" id="inpTitle"
                        class="form-control form-control-lg bg-dark text-white border-secondary"
                        placeholder="İçerik başlığını giriniz">
                </div>

                <div class="mb-4">
                    <label class="form-label text-muted small fw-bold">SIRALAMA NO</label>
                    <input type="number" id="inpOrder" class="form-control bg-dark text-white border-secondary"
                        value="1">
                    <div class="form-text text-muted small">Listenin hangi sırasında görüneceğini belirler.</div>
                </div>

                <!-- Dynamic Meta Fields (e.g. Duration for video) -->
                <div id="metaDynamicFields"></div>
            </div>

            <!-- Right: Content Workspace -->
            <div class="flex-grow-1 overflow-auto custom-scrollbar bg-dark position-relative">

                <!-- Inner Container -->
                <div class="container-fluid p-0 h-100">

                    <!-- Standard Content Editors (Video, PDF, HTML) -->
                    <div id="standardEditorArea" class="p-5 mx-auto" style="max-width: 1000px;">
                        <!-- Injected via JS -->
                    </div>

                    <!-- Quiz Builder Area -->
                    <div id="quizBuilderArea" class="d-none h-100 d-flex flex-column">
                        <!-- Sticky Tools -->
                        <div
                            class="p-3 bg-dark-subtle border-bottom border-secondary d-flex justify-content-between align-items-center sticky-top shadow-sm z-index-dropdown">
                            <div class="text-muted small">
                                <i class="bi bi-info-circle me-1"></i>Toplam <strong id="qbQuestionCount"
                                    class="text-white">0</strong> soru eklendi.
                            </div>
                            <div class="d-flex gap-2">
                                <button class="btn btn-sm btn-outline-secondary text-white"
                                    onclick="window.ContentManager.toggleAllQuestions(false)">Hepsini Daralt</button>
                                <button class="btn btn-sm btn-outline-secondary text-white"
                                    onclick="window.ContentManager.toggleAllQuestions(true)">Hepsini Genişlet</button>
                                <button class="btn btn-sm btn-primary" onclick="window.ContentManager.addQuestion()">
                                    <i class="bi bi-plus-lg me-1"></i>Yeni Soru Ekle
                                </button>
                            </div>
                        </div>

                        <!-- Questions List -->
                        <div id="quizQuestionsList" class="p-4 d-flex flex-column gap-3 pb-5 mx-auto w-100"
                            style="max-width: 1000px;">
                            <!-- Question Cards -->
                        </div>

                        <!-- Bottom Add Button -->
                        <div class="text-center pb-5 pt-2">
                            <button class="btn btn-outline-secondary text-muted border-dashed py-3 px-5 rounded-pill"
                                onclick="window.ContentManager.addQuestion()">
                                <i class="bi bi-plus-circle me-2"></i>Bir Soru Daha Ekle
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>